{{ define "pages/sales/customer_detail.html" }}
{{ template "layouts/base.html" . }}
{{ end }}

{{ define "title" }}Customer {{ .Data.Customer.Code }}{{ end }}

{{ define "content" }}
<div class="customer-detail-wrapper">
    <header>
        <h1>Customer: {{ .Data.Customer.Name }}</h1>
        <p>
            Code: <strong>{{ .Data.Customer.Code }}</p></strong> |
            Status:
            {{ if .Data.Customer.IsActive }}
            <span class="badge badge-success">Active</span>
            {{ else }}
            <span class="badge badge-secondary">Inactive</span>
            {{ end }}
        </p>
    </header>

    <!-- Action Buttons -->
    <section class="actions">
        <div role="group">
            <a href="/sales/customers" role="button" class="secondary">‚Üê Back to List</a>
            <a href="/sales/customers/{{ .Data.Customer.ID }}/edit" role="button">Edit Customer</a>
            <a href="/sales/quotations/new?customer_id={{ .Data.Customer.ID }}" role="button" class="secondary">+ New Quotation</a>
            <a href="/sales/orders/new?customer_id={{ .Data.Customer.ID }}" role="button" class="secondary">+ New Order</a>
        </div>
    </section>

    <!-- Basic Information -->
    <section>
        <h2>Basic Information</h2>
        <div class="grid">
            <div>
                <label>Customer Code</label>
                <p><strong>{{ .Data.Customer.Code }}</strong></p>
            </div>
            <div>
                <label>Customer Name</label>
                <p><strong>{{ .Data.Customer.Name }}</strong></p>
            </div>
            <div>
                <label>Country</label>
                <p>{{ .Data.Customer.Country }}</p>
            </div>
            <div>
                <label>Status</label>
                <p>
                    {{ if .Data.Customer.IsActive }}
                    <span class="badge badge-success">Active</span>
                    {{ else }}
                    <span class="badge badge-secondary">Inactive</span>
                    {{ end }}
                </p>
            </div>
        </div>

        <div class="grid">
            <div>
                <label>Email</label>
                <p>{{ if .Data.Customer.Email }}{{ .Data.Customer.Email }}{{ else }}-{{ end }}</p>
            </div>
            <div>
                <label>Phone</label>
                <p>{{ if .Data.Customer.Phone }}{{ .Data.Customer.Phone }}{{ else }}-{{ end }}</p>
            </div>
            <div>
                <label>Tax ID / NPWP</label>
                <p>{{ if .Data.Customer.TaxID }}{{ .Data.Customer.TaxID }}{{ else }}-{{ end }}</p>
            </div>
        </div>
    </section>

    <!-- Address -->
    <section>
        <h2>Address</h2>
        <div class="grid">
            <div>
                <label>Street Address</label>
                <p>
                    {{ if .Data.Customer.AddressLine1 }}{{ .Data.Customer.AddressLine1 }}{{ else }}-{{ end }}<br>
                    {{ if .Data.Customer.AddressLine2 }}{{ .Data.Customer.AddressLine2 }}{{ end }}
                </p>
            </div>
            <div>
                <label>City / State</label>
                <p>
                    {{ if .Data.Customer.City }}{{ .Data.Customer.City }}{{ else }}-{{ end }}
                    {{ if .Data.Customer.State }}, {{ .Data.Customer.State }}{{ end }}
                </p>
            </div>
            <div>
                <label>Postal Code</label>
                <p>{{ if .Data.Customer.PostalCode }}{{ .Data.Customer.PostalCode }}{{ else }}-{{ end }}</p>
            </div>
        </div>
    </section>

    <!-- Financial Settings -->
    <section>
        <h2>Financial Settings</h2>
        <div class="grid">
            <div>
                <label>Credit Limit</label>
                <p><strong>{{ printf "%.2f" .Data.Customer.CreditLimit }}</strong></p>
            </div>
            <div>
                <label>Payment Terms</label>
                <p><strong>{{ .Data.Customer.PaymentTermsDays }} days</strong></p>
            </div>
            <div>
                <label>Current Outstanding</label>
                <p><em></em>Coming in Phase 9.3 (AR)</em></p>
            </div>
            <div>
                <label>Credit Available</label>
                <p><em>Coming in Phase 9.3 (AR)</em></p>
            </div>
        </div>
    </section>

    <!-- Additional Information -->
    <section>
        <h2>Additional Information</h2>
        <div class="grid">
            <div>
                <label>Created By</label>
                <p>User #{{ .Data.Customer.CreatedBy }}</p>
            </div>
            <div>
                <label>Created At</label>
                <p>{{ .Data.Customer.CreatedAt.Format "2006-01-02 15:04:05" }}</p>
            </div>
            <div>
                <label>Updated At</label>
                <p>{{ .Data.Customer.UpdatedAt.Format "2006-01-02 15:04:05" }}</p>
            </div>
        </div>

        {{ if .Data.Customer.Notes }}
        <div>
            <label>Notes</label>
            <p style="white-space: pre-wrap;">{{ .Data.Customer.Notes }}</p>
        </div>
        {{ end }}
    </section>

    <!-- Recent Activity (Placeholder for future) -->
    <section>
        <h2>Recent Activity</h2>
        <article>
            <p><em>Transaction history will be available</p> in future updates</em></p>
            <ul>
                <li>Recent quotations</li>
                <li>Recent sales orders</li>
                <li>Recent invoices (Phase 9.3)</li>
                <li>Payment history (Phase 9.3)</li>
            </ul>
        </article>
    </section>
</div>

<style>
.badge {
    display: inline-block;
    padding: 0.25em 0.6em;
    font-size: 0.85em;
    font-weight: 600;
    line-height: 1;
    text-align: center;
    white-space: nowrap;
    vertical-align: baseline;
    border-radius: 0.25rem;
}
.badge-success { background-color: #198754; color: white; }
.badge-secondary { background-color: #6c757d; color: white; }
.actions { margin: 1rem 0; }
section {
    margin-bottom: 2rem;
}
section h2 {
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--form-element-border-color);
}
</style>
{{ end }}
